{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1ade8b4ba10f83d0f665","webpack:///./src/shortcode-tokenizer.js"],"names":["TEXT","ERROR","OPEN","CLOSE","SELF_CLOSING","RX_KEY","RX_PARAM","RX_PARAMS","RX_ENCLOSURE","RX_OPEN","RX_SELFCLOSING","RX_CLOSE","rxParams","RegExp","substring","length","rxEnclosure","rxOpen","rxClose","rxSelfclosing","getTokenType","str","castValue","value","replace","test","parseFloat","toLowerCase","thisIsNotDefined","Token","type","body","pos","name","children","params","isClosed","init","match","matchBody","initName","initParams","paramStr","reduce","paramToken","trim","equal","indexOf","rx","SyntaxError","token","ShortcodeTokenizer","input","options","strict","skipWhiteSpace","buf","originalBuf","Error","tokens","allTokens","_next","Array","isArray","push","stack","ast","parent","canClose","err","pop","index","console","warn","Object","assign"],"mappings":"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","file":"shortcode-tokenizer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"shortcodeTokenizer\"] = factory();\n\telse\n\t\troot[\"shortcodeTokenizer\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1ade8b4ba10f83d0f665\n **/","/** @module ShortcodeTokenizer */\n\n/* tokens */\nconst TEXT = 'TEXT'\nconst ERROR = 'ERROR'\nconst OPEN = 'OPEN'\nconst CLOSE = 'CLOSE'\nconst SELF_CLOSING = 'SELF_CLOSING'\n\n/* eslint-disable */\n\n/* matches code name */\nconst RX_KEY = '[a-zA-Z][a-zA-Z0-9_-]*'\n\n/* matches paramters */\nconst RX_PARAM =       RX_KEY + '=\\\\d+\\\\.\\\\d+' +    // floats\n                 '|' + RX_KEY + '=\\\\d+' +           // ints\n                 '|' + RX_KEY + '=\"[^\\\\]\"]*\"' +     // double-qouted strings\n                 '|' + RX_KEY + '=\\'[^\\\\]\\']*\\'' +  // single-qouted strings\n                 '|' + RX_KEY                       // flags\nconst RX_PARAMS = '(?:(?:' + RX_PARAM + ')(?:(?!\\\\s+/?\\\\])\\\\s|))+'\n\n/* matches all code token types, used for quickly\n   finding potentia code tokens */\nconst RX_ENCLOSURE   = '\\\\[\\\\/?[a-zA-Z][^\\\\]]+\\\\]'\n/* matches opening code tokens [row] */\nconst RX_OPEN        = '\\\\[(' + RX_KEY + ')(\\\\s' + RX_PARAMS + ')?\\\\]'\n/* matches self-closing code tokens [row/] */\nconst RX_SELFCLOSING = '\\\\[(' + RX_KEY + ')(\\\\s' + RX_PARAMS + ')?\\\\s?\\\\/\\\\]'\n/* matches close code tokens [/row] */\nconst RX_CLOSE       = '\\\\[\\\\/(' + RX_KEY + ')\\\\]'\n\n/* case-insensitive regular expressions */\nconst rxParams      = new RegExp(RX_PARAMS.substring(0, RX_PARAMS.length - 1), 'ig')\nconst rxEnclosure   = new RegExp(RX_ENCLOSURE, 'i')\nconst rxOpen        = new RegExp(RX_OPEN, 'i')\nconst rxClose       = new RegExp(RX_CLOSE, 'i')\nconst rxSelfclosing = new RegExp(RX_SELFCLOSING, 'i')\n\n/* eslint-enable */\n\n/**\n * Get token type based on token-string.\n *\n * Note: assuming that this is not a TEXT token\n *\n * @param {string} str\n * @returns {string} token type\n */\nfunction getTokenType(str) {\n  if (str[1] === '/') {\n    return CLOSE\n  }\n  if (str[str.length - 2] === '/') {\n    return SELF_CLOSING\n  }\n  return OPEN\n}\n\n/**\n * Casts input string to native types.\n *\n * @param {string} value\n * @returns {*} mixed value\n */\nfunction castValue(value) {\n  value = value.replace(/(^['\"]|['\"]$)/g, '')\n  if (/^\\d+$/.test(value)) return +value\n  if (/^\\d+.\\d+$/.test(value)) return parseFloat(value)\n  if (/^['\"]?(true|false|yes|no)['\"]?$/i.test(value)) {\n    value = value\n      .replace(/(^['\"]|['\"]$)/g, '')\n      .toLowerCase()\n    return value === 'true' || value === 'yes'\n  }\n  if (value === 'undefined') return typeof thisIsNotDefined\n  if (value === 'null') return null\n  return value\n}\n\n/**\n * Token class is used both as a token during tokenization/lexing\n * and as a node in the resulting AST.\n *\n * @access private\n */\nexport class Token {\n  constructor(type, body, pos = 0) {\n    this.name = null\n    this.type = type\n    this.body = body\n    this.pos = pos\n    this.children = []\n    this.params = {}\n    this.isClosed = type === SELF_CLOSING\n    this.init()\n  }\n\n  /**\n   * @access private\n   */\n  init() {\n    if (this.type !== TEXT && this.type !== ERROR) {\n      const match = this.matchBody()\n      this.initName(match)\n      if (match[2]) {\n        this.initParams(match[2])\n      }\n    }\n  }\n\n  /**\n   * @access private\n   */\n  initName(match) {\n    this.name = match[1]\n  }\n\n  /**\n   * @access private\n   */\n  initParams(paramStr) {\n    const match = paramStr.match(rxParams)\n    this.params = match.reduce((params, paramToken) => {\n      paramToken = paramToken.trim()\n      let equal = paramToken.indexOf('=')\n      if (!~equal) {\n        params[paramToken] = true\n      } else {\n        params[paramToken.substring(0, equal)] = castValue(paramToken.substring(equal + 1))\n      }\n      return params\n    }, {})\n  }\n\n  /**\n   * @access private\n   */\n  matchBody() {\n    let rx\n    if (this.type === CLOSE) {\n      rx = rxClose\n    } else if (this.type === OPEN) {\n      rx = rxOpen\n    } else if (this.type === SELF_CLOSING) {\n      rx = rxSelfclosing\n    } else {\n      throw new SyntaxError('Unknown token: ' + this.type)\n    }\n\n    let match = this.body.match(rx)\n    if (match === null) {\n      throw new SyntaxError('Invalid ' + this.type + ' token: ' + this.body)\n    }\n    return match\n  }\n\n  /**\n   * Determines if this token can close the param token.\n   *\n   * @access public\n   * @param {Token} token another token\n   * @returns {boolean}\n   */\n  canClose(token) {\n    return this.name === token.name\n  }\n}\n\n/**\n * Creates a new tokenizer.\n *\n * Pass in input as first param or later using `input()`\n *\n * @param {string} [input=null] Optional input to tokenize\n * @param {Object} [options] options object\n * @param {boolean} [options.strict=true] strict mode\n * @param {boolean} [options.skipWhiteSpace=false] will ignore tokens containing only white space (basically all \\s)\n */\nexport default class ShortcodeTokenizer {\n\n  constructor(input = null, options = {strict: true, skipWhiteSpace: false}) {\n    if (typeof options === 'boolean') {\n      options = {strict: options, skipWhiteSpace: false}\n    }\n    this.options = options\n    this.buf = null\n    this.originalBuf = null\n    this.pos = 0\n    if (input) {\n      this.input(input)\n    }\n  }\n\n  /**\n   * @deprecated use options.strict\n   */\n  get strict() {\n    console.warn(`Deprecated: use options.strict instead`)\n    return this.options.strict\n  }\n\n  /**\n   * @deprecated use options.strict\n   */\n  set strict(value) {\n    console.warn(`Deprecated: use options.strict = ${value} instead`)\n    this.options.strict = value\n  }\n\n  /**\n   * Sets input buffer with a new input string.\n   *\n   * @param {string} input template string\n   * @throws {Error} Invalid input\n   * @returns {this} returns this for chaining\n   */\n  input(input) {\n    if (typeof input !== 'string') {\n      throw new Error('Invalid input')\n    }\n\n    this.buf = this.originalBuf = input\n    this.pos = 0\n    return this\n  }\n\n  /**\n   * Resets input buffer and position to their origial values.\n   *\n   * @returns {this} returns this for chaining\n   */\n  reset() {\n    this.buf = this.originalBuf\n    this.pos = 0\n    return this\n  }\n\n  /**\n   * Creates a token generator.\n   *\n   * @throws {Error} Invalid input\n   * @returns {Token[]} An array of Token instances\n   */\n  tokens(input = null) {\n    if (input) {\n      this.input(input)\n    }\n\n    if (typeof this.buf !== 'string') {\n      throw new Error('Invalid input')\n    }\n\n    let tokens = []\n    let allTokens = []\n    while ((tokens = this._next()) !== null) {\n      tokens = Array.isArray(tokens) ? tokens : [tokens]\n      allTokens.push(...tokens)\n    }\n    return allTokens\n  }\n\n  /**\n   * Uses the tokens generator to build an AST from the tokens.\n   *\n   * @see tokens\n   * @returns {array} an array of AST roots\n   */\n  ast(input = null) {\n    let tokens = this.tokens(input)\n    let stack = []\n    let ast = []\n    let parent = null\n    let token\n    for (token of tokens) {\n      if (token.type === TEXT) {\n        if (this.options.skipWhiteSpace && token.body.replace(/\\s+/g, '').length === 0) {\n          continue\n        }\n        if (!parent) {\n          ast.push(token)\n        } else {\n          parent.children.push(token)\n        }\n      } else if (token.type === OPEN) {\n        if (!parent) {\n          parent = token\n          ast.push(parent)\n        } else {\n          parent.children.push(token)\n          stack.push(parent)\n          parent = token\n        }\n      } else if (token.type === CLOSE) {\n        if (!parent || !token.canClose(parent)) {\n          if (this.options.strict) {\n            throw new SyntaxError('Unmatched close token: ' + token.body)\n          } else {\n            let err = new Token(ERROR, token.body)\n            if (!parent) {\n              ast.push(err)\n            } else {\n              parent.children.push(err)\n            }\n          }\n        } else {\n          parent.isClosed = true\n          parent = stack.pop()\n        }\n      } else if (token.type === SELF_CLOSING) {\n        if (!parent) {\n          ast.push(token)\n        } else {\n          parent.children.push(token)\n        }\n      } else {\n        throw new SyntaxError('Unknown token: ' + token.type)\n      }\n    }\n    if (parent) {\n      if (this.options.strict) {\n        throw new SyntaxError('Unmatched open token: ' + parent.body)\n      } else {\n        ast.push(new Token(ERROR, token.body))\n      }\n    }\n    return ast\n  }\n\n  /**\n   * Internal function used to retrieve the next token from the current\n   * position in the input buffer.\n   *\n   * @private\n   * @returns {Token} returns the next Token from the input buffer\n   */\n  _next() {\n    if (!this.buf) {\n      return null\n    }\n\n    let match = this.buf.match(rxEnclosure)\n\n    // all text\n    if (match === null) {\n      let token = new Token(TEXT, this.buf, this.pos)\n      this.pos += this.buf.length\n      this.buf = null\n      return token\n    }\n\n    let tokens = []\n\n    // first part is text\n    if (match.index !== 0) {\n      tokens.push(new Token(\n        TEXT,\n        this.buf.substring(0, match.index),\n        this.pos\n      ))\n    }\n\n    // matching token\n    tokens.push(new Token(\n      getTokenType(match[0]),\n      match[0],\n      this.pos + match.index\n    ))\n\n    // shorten buffer\n    this.buf = this.buf.substring(match.index + match[0].length)\n    this.pos += match.index + match[0].length\n    if (this.buf.length === 0) {\n      this.buf = null\n    }\n    return tokens\n  }\n}\n\nObject.assign(ShortcodeTokenizer, {\n  TEXT,\n  ERROR,\n  OPEN,\n  CLOSE,\n  SELF_CLOSING,\n  rxParams,\n  rxEnclosure,\n  rxOpen,\n  rxClose,\n  rxSelfclosing\n})\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/shortcode-tokenizer.js\n **/"],"sourceRoot":""}